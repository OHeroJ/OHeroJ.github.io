<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Swift, iOS" />










<meta property="og:type" content="website">
<meta property="og:title" content="loveli">
<meta property="og:url" content="http://loveli.site/page/6/index.html">
<meta property="og:site_name" content="loveli">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="loveli">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://loveli.site/page/6/"/>





  <title>loveli - 浮生流年</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">loveli</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">浮生流年</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/08/24/iOS 开发技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/24/iOS 开发技巧/" itemprop="url">iOS 开发技巧</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-24T08:42:11+08:00">
                2016-08-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/24/iOS 开发技巧/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/08/24/iOS 开发技巧/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/08/24/iOS 开发技巧/" class="leancloud_visitors" data-flag-title="iOS 开发技巧">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="XCode快捷键"><a href="#XCode快捷键" class="headerlink" title="XCode快捷键"></a>XCode快捷键</h2><ol>
<li><code>cmd + shift + j</code> : 定位当前代码文件所在的目录中的位置</li>
<li><code>cmd + shift + o</code> : 寻找类对应的代码文件</li>
<li><code>cmd + shift + f</code> : 从全局搜索全局文件</li>
<li><code>cmd + \</code> : 取消断点  或者打断点</li>
<li><code>cmd + alt +  &lt;-</code> : 折叠代码</li>
<li><code>cmd + alt +  -&gt;</code> : 展开代码</li>
</ol>
<h2 id="封装库的代码细节处理"><a href="#封装库的代码细节处理" class="headerlink" title="封装库的代码细节处理"></a>封装库的代码细节处理</h2><ol>
<li><p>忽略编译警告</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#pragma clang diagnostic push</div><div class="line">#pragma clang diagnostic ignored &quot;-Warc-retain-cycles&quot;</div><div class="line">    self.completionBlock = ^ &#123;</div><div class="line">        ...</div><div class="line">    &#125;;</div><div class="line">#pragma clang diagnostic pop</div></pre></td></tr></table></figure>
</li>
<li><p><a href="http://ios.jobbole.com/85019/" target="_blank" rel="noopener">剖析@weakify 和 @strongify：</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#define weakify(...)</div><div class="line">    rac_keywordify</div><div class="line">    metamacro_foreach_cxt(rac_weakify_,, __weak, __VA_ARGS__)</div><div class="line"> </div><div class="line">#define strongify(...)</div><div class="line">    rac_keywordify</div><div class="line">    _Pragma(&quot;clang diagnostic push&quot;)</div><div class="line">    _Pragma(&quot;clang diagnostic ignored &quot;-Wshadow&quot;&quot;)</div><div class="line">    metamacro_foreach(rac_strongify_,, __VA_ARGS__)</div><div class="line">    _Pragma(&quot;clang diagnostic pop&quot;)</div></pre></td></tr></table></figure>
</li>
<li><p>断言的使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">NSParameterAssert(playButtonImage != nil);</div><div class="line">NSParameterAssert(pauseButtonImage != nil);</div><div class="line">NSParameterAssert(labelFont != nil);</div><div class="line">NSParameterAssert(backgroundColor != nil);</div><div class="line">NSParameterAssert(tintColor != nil);</div><div class="line">NSParameterAssert(audioCategory != nil);</div></pre></td></tr></table></figure>
</li>
<li><p>通知的移除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (void)dealloc</div><div class="line">&#123;</div><div class="line">    [[NSNotificationCenter defaultCenter] removeObserver:self];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="xocde-字体设置："><a href="#xocde-字体设置：" class="headerlink" title="xocde 字体设置："></a>xocde 字体设置：</h2><p>Xcode我喜欢的字体是 Courier New 16号字体</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/08/23/iOS 之 AOP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/23/iOS 之 AOP/" itemprop="url">iOS 之 AOP</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-23T22:37:39+08:00">
                2016-08-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/23/iOS 之 AOP/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/08/23/iOS 之 AOP/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/08/23/iOS 之 AOP/" class="leancloud_visitors" data-flag-title="iOS 之 AOP">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>在iOS中实现AOP的核心技术是Runtime,使用Runtime的Method Swizzling黑魔法，我们可以移花接木，在运行时将方法的具体实现添油加醋、偷梁换柱</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (void)swizzleMethod:(SEL)origSelector withMethod:(SEL)newSelector</div><div class="line">&#123;</div><div class="line">    Class class = [self class];</div><div class="line"></div><div class="line">    Method originalMethod = class_getInstanceMethod(class, origSelector);</div><div class="line">    Method swizzledMethod = class_getInstanceMethod(class, newSelector);</div><div class="line"></div><div class="line">    BOOL didAddMethod = class_addMethod(class,</div><div class="line">                                        origSelector,</div><div class="line">                                        method_getImplementation(swizzledMethod),</div><div class="line">                                        method_getTypeEncoding(swizzledMethod));</div><div class="line">    if (didAddMethod) &#123;</div><div class="line">        class_replaceMethod(class,</div><div class="line">                            newSelector,</div><div class="line">                            method_getImplementation(originalMethod),</div><div class="line">                            method_getTypeEncoding(originalMethod));</div><div class="line">    &#125; else &#123;</div><div class="line">        method_exchangeImplementations(originalMethod, swizzledMethod);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="业务埋点、日志打印分离"><a href="#业务埋点、日志打印分离" class="headerlink" title="业务埋点、日志打印分离"></a>业务埋点、日志打印分离</h3><p><code>Aspects</code> 一个基于Objective-c的AOP开发框架,只提供两个API:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ (id)aspect_hookSelector:(SEL)selector</div><div class="line">                         withOptions:(AspectOptions)options</div><div class="line">                      usingBlock:(id)block</div><div class="line">                           error:(NSError **)error;</div><div class="line">- (id)aspect_hookSelector:(SEL)selector</div><div class="line">                     withOptions:(AspectOptions)options</div><div class="line">                      usingBlock:(id)block</div><div class="line">                           error:(NSError **)error;</div></pre></td></tr></table></figure></p>
<p>一般对于这种统计的埋点 我们会配置相关文件，然后读取相关文件的信息，解析 <code>Class</code> 和 <code>selector</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">NSDictionary *analyticsConfiguration()</div><div class="line">&#123;</div><div class="line">    return @&#123;</div><div class="line">             @&quot;trackedScreens&quot; : @[    // 页面统计</div><div class="line">                     @&#123;</div><div class="line">                         @&quot;class&quot; : @&quot;ZOCMainViewController&quot;,</div><div class="line">                         @&quot;label&quot; : @&quot;Main screen&quot;</div><div class="line">                         &#125;</div><div class="line">                     ],</div><div class="line">             @&quot;trackedEvents&quot; : @[  // 交互事件统计</div><div class="line">                     @&#123;</div><div class="line">                         @&quot;class&quot; : @&quot;ZOCMainViewController&quot;,</div><div class="line">                         @&quot;selector&quot; : @&quot;loginViewFetchedUserInfo:user:&quot;,</div><div class="line">                         @&quot;label&quot; : @&quot;Login with Facebook&quot;</div><div class="line">                         &#125;,</div><div class="line">                     @&#123;</div><div class="line">                         @&quot;class&quot; : @&quot;ZOCMainViewController&quot;,</div><div class="line">                         @&quot;selector&quot; : @&quot;loginViewShowingLoggedOutUser:&quot;,</div><div class="line">                         @&quot;label&quot; : @&quot;Logout with Facebook&quot;</div><div class="line">                         &#125;,</div><div class="line">                     @&#123;</div><div class="line">                         @&quot;class&quot; : @&quot;ZOCMainViewController&quot;,</div><div class="line">                         @&quot;selector&quot; : @&quot;loginView:handleError:&quot;,</div><div class="line">                         @&quot;label&quot; : @&quot;Login error with Facebook&quot;</div><div class="line">                         &#125;,</div><div class="line">                     @&#123;</div><div class="line">                         @&quot;class&quot; : @&quot;ZOCMainViewController&quot;,</div><div class="line">                         @&quot;selector&quot; : @&quot;shareButtonPressed:&quot;,</div><div class="line">                         @&quot;label&quot; : @&quot;Share button&quot;</div><div class="line">                         &#125;</div><div class="line">                     ]</div><div class="line">             &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后就是 进行 method_swizzing,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">// .h</div><div class="line">@interface YTViewControllerIntercepter : NSObject</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">// .m</div><div class="line">@implementation YTViewControllerIntercepter</div><div class="line"></div><div class="line">+ (void)load &#123;</div><div class="line">    [super load];</div><div class="line">    [YTViewControllerIntercepter shareInstance];</div><div class="line">&#125;</div><div class="line"></div><div class="line">+ (instancetype)shareInstance &#123;</div><div class="line">    static dispatch_once_t onceToken;</div><div class="line">    static YTViewControllerIntercepter *sharedInstance;</div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        sharedInstance = [[YTViewControllerIntercepter alloc] init];</div><div class="line">    &#125;);</div><div class="line">    return sharedInstance;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (instancetype)init &#123;</div><div class="line">    if (self = [super init]) &#123;</div><div class="line"></div><div class="line">         /* 在这里做好方法拦截 */</div><div class="line">        [self setupWithConfiguration:analyticsConfiguration()];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)setupWithConfiguration:(NSDictionary *)configuration &#123;</div><div class="line"></div><div class="line">    for (NSDictionary *trackedScreen in configuration[@&quot;trackedScreens&quot;]) &#123;</div><div class="line">        Class clazz = NSClassFromString(trackedScreen[@&quot;class&quot;]);</div><div class="line"></div><div class="line">        [clazz aspect_hookSelector:@selector(viewWillAppear:) withOptions:AspectPositionAfter usingBlock:^(id&lt;AspectInfo&gt; aspectInfo) &#123;</div><div class="line">            dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">                NSString *viewName = trackedScreen[@&quot;label&quot;];</div><div class="line">//                [tracker trackScreenHitWithName:viewName];</div><div class="line"></div><div class="line">            &#125;);</div><div class="line"></div><div class="line">        &#125;error:nil];</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // events tracking</div><div class="line">    for (NSDictionary *trackedEvents in configuration[@&quot;trackedEvents&quot;]) &#123;</div><div class="line">        Class clazz = NSClassFromString(trackedEvents[@&quot;class&quot;]);</div><div class="line">        SEL selektor = NSSelectorFromString(trackedEvents[@&quot;selector&quot;]);</div><div class="line"></div><div class="line">        [clazz aspect_hookSelector:selektor</div><div class="line">                       withOptions:AspectPositionAfter</div><div class="line">                        usingBlock:^(id&lt;AspectInfo&gt; aspectInfo) &#123;</div><div class="line">                            dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),</div><div class="line">                                           ^&#123;</div><div class="line">//                                               UserActivityButtonPressedEvent *buttonPressEvent =</div><div class="line">//                                               [UserActivityButtonPressedEvent</div><div class="line">//                                                eventWithLabel:trackedEvents[@&quot;label&quot;]];</div><div class="line">//                                               [tracker trackEvent:buttonPressEvent];</div><div class="line">                                           &#125;);</div><div class="line">                        &#125;</div><div class="line">                             error:nil];</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面有个提示，摘抄自<a href="http://nshipster.com/method-swizzling/" target="_blank" rel="noopener">nshsipster</a></p>
<blockquote>
<p> Swizzling should always be done in +load ?<br>+load is sent when the class is initially loaded, while +initialize is called just before the application calls its first method on that class or an instance of that class. Both are optional, and are executed only if the method is implemented.<br>Because method swizzling affects global state, it is important to minimize the possibility of race conditions. +load is guaranteed to be loaded during class initialization, which provides a modicum of consistency for changing system-wide behavior. By contrast, +initialize provides no such guarantee of when it will be executed—in fact, it may never be called, if that class is never messaged directly by the app.</p>
</blockquote>
<h3 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h3><ol>
<li>解耦</li>
</ol>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><ol>
<li>变更方法的时候，可能会忽略修改配置文件</li>
<li>这个方法被重构了。或者新加的方法忘了加统计了</li>
</ol>
<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ol>
<li><a href="http://nshipster.com/method-swizzling/" target="_blank" rel="noopener">Method Swizzling</a></li>
<li><a href="http://my.oschina.net/leejun2005/blog/504732" target="_blank" rel="noopener">iOS 统计打点那些事</a></li>
<li><a href="https://github.com/oa414/objc-zen-book-cn#%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B" target="_blank" rel="noopener">禅与 Objective-C 编程艺术</a></li>
<li><a href="http://ios.jobbole.com/86612/?utm_source=top.caibaojian.com/112246" target="_blank" rel="noopener">漫谈iOS AOP编程之路</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/08/21/React-Native入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/21/React-Native入门/" itemprop="url">React-Native 入门</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-21T18:51:28+08:00">
                2016-08-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/21/React-Native入门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/08/21/React-Native入门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/08/21/React-Native入门/" class="leancloud_visitors" data-flag-title="React-Native 入门">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="为什么学习React-Native"><a href="#为什么学习React-Native" class="headerlink" title="为什么学习React-Native?"></a>为什么学习React-Native?</h2><h3 id="动态配置？"><a href="#动态配置？" class="headerlink" title="动态配置？"></a>动态配置？</h3><p>从 Server 获取配置 –&gt; 解析 –&gt; 执行 native 代码：</p>
<ol>
<li>通过请求获取JSON格式的配置文件</li>
<li>配置文件中标记了每个元素的属性，比如位置， 颜色， 图片URL等</li>
<li>解析完JSON后， 我们调用Object-C的代码，完成UI控件的渲染。</li>
</ol>
<p>此方法其实就是 移动端 和 服务器端 约定的一套协议，但是协议内容 严重依赖于 应用内要展示的内容， 不利于扩展。<br>提供的是一些配置信息，而不是很方便的提供逻辑信息。</p>
<p>我们只是在解析字符串， 它完全不具备运行和调试的能力。</p>
<blockquote>
<p>React 是一套可以用简洁的语法高效绘制DOM的框架</p>
</blockquote>
<p>当然，React 并不是前端开发的全部。从之前的描述也能看出，它专注于 UI 部分，对应到 MVC 结构中就是 View 层。要想实现完整的 MVC 架构，还需要 Model 和 Controller 的结构。在前端开发时，我们可以采用 Flux 和 Redux 架构，它们并非框架(Library)，而是和 MVC 一样都是一种架构设计(Architecture)。</p>
<p>React Native 与 Hybrid 完全没有关系，它只不过是以 JavaScript 的形式告诉 Objective-C 该执行什么代码</p>
<h3 id="JavaScript-调用-Objective-C"><a href="#JavaScript-调用-Objective-C" class="headerlink" title="JavaScript 调用 Objective-C"></a>JavaScript 调用 Objective-C</h3><h4 id="js-怎么知道-oc-有哪些方法可以调用？"><a href="#js-怎么知道-oc-有哪些方法可以调用？" class="headerlink" title="js 怎么知道 oc 有哪些方法可以调用？"></a>js 怎么知道 oc 有哪些方法可以调用？</h4><h4 id="闭包与回调"><a href="#闭包与回调" class="headerlink" title="闭包与回调"></a>闭包与回调</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/08/10/优雅处理-bad-enum-configurations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/10/优雅处理-bad-enum-configurations/" itemprop="url">优雅处理 bad enum configurations</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-10T23:10:48+08:00">
                2016-08-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/10/优雅处理-bad-enum-configurations/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/08/10/优雅处理-bad-enum-configurations/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/08/10/优雅处理-bad-enum-configurations/" class="leancloud_visitors" data-flag-title="优雅处理 bad enum configurations">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Using-an-enum-for-configuration"><a href="#Using-an-enum-for-configuration" class="headerlink" title="Using an enum for configuration"></a>Using an enum for configuration</h3><p>上例子：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">CellStyle</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> login</div><div class="line">    <span class="keyword">case</span> profile</div><div class="line">    <span class="keyword">case</span> settings</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonTableCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> style: <span class="type">CellStyle</span> &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            configureStyle()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ...</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">configureStyle</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">switch</span> cellStyle &#123;</div><div class="line">        <span class="keyword">case</span> .login:</div><div class="line">            <span class="comment">// configure style for login view</span></div><div class="line">            textLabel?.textColor = .red()</div><div class="line">            textLabel?.font = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleBody</span>)</div><div class="line"></div><div class="line">            detailTextLabel?.textColor = .blue()</div><div class="line">            detailTextLabel?.font = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleTitle3</span>)</div><div class="line"></div><div class="line">            accessoryView = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">"chevron"</span>))</div><div class="line">        <span class="keyword">case</span> .settings:</div><div class="line">            <span class="comment">// configure style for settings view</span></div><div class="line">            textLabel?.textColor = .purple()</div><div class="line">            textLabel?.font = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleTitle1</span>)</div><div class="line"></div><div class="line">            detailTextLabel?.textColor = .green()</div><div class="line">            detailTextLabel?.font = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleCaption1</span>)</div><div class="line"></div><div class="line">            accessoryView = <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">"checkmark"</span>))</div><div class="line">         <span class="keyword">case</span> .profile:</div><div class="line">            <span class="comment">// configure style for profile view</span></div><div class="line">            <span class="comment">// ...</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SettingsViewController</span>: <span class="title">UITableViewController</span> </span>&#123;</div><div class="line">   <span class="comment">// ...</span></div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">      <span class="comment">// create and configure cell</span></div><div class="line">      cell.style = .settings</div><div class="line">      <span class="keyword">return</span> cell</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>This is so bad!😢</strong></p>
<h3 id="Why-enum-configurations-are-bad"><a href="#Why-enum-configurations-are-bad" class="headerlink" title="Why enum configurations are bad"></a>Why enum configurations are bad</h3><p>有些人会觉得这个模式很ok哇， “is flexible”，如果你有一个新的CellStyle, 你只需要添加一个<code>case</code>,然后在switch添加一处处理。‘set any style you want’。</p>
<p>但是如果这个cell是一个library，你就没有办法添加新的 case, 这个时候就无法 添加自己想要的cellstyle了，或者你也许可以提PR.那么对于使用这个lib的人来说，这个库设计的是不灵活的。</p>
<p>还有就是这个 判断case 分支越多，代码就越难看。</p>
<h4 id="如何改进这种设计"><a href="#如何改进这种设计" class="headerlink" title="如何改进这种设计"></a>如何改进这种设计</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CellStyle</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> labelColor: <span class="type">UIColor</span></div><div class="line">    <span class="keyword">let</span> labelFont: <span class="type">UIFont</span></div><div class="line">    <span class="keyword">let</span> detailColor: <span class="type">UIColor</span></div><div class="line">    <span class="keyword">let</span> detailFont: <span class="type">UIFont</span></div><div class="line">    <span class="keyword">let</span> accessory: <span class="type">UIImage</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">init</span>(labelColor: <span class="type">UIColor</span> = .black(),</div><div class="line">         labelFont: <span class="type">UIFont</span> = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleTitle1</span>),</div><div class="line">         detailColor: <span class="type">UIColor</span> = .lightGray(),</div><div class="line">         detailFont: <span class="type">UIFont</span> = .preferredFont(forTextStyle: <span class="type">UIFontTextStyleCaption1</span>),</div><div class="line">         accessory: <span class="type">UIImage</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.labelColor = labelColor</div><div class="line">        <span class="keyword">self</span>.labelFont = labelFont</div><div class="line">        <span class="keyword">self</span>.detailColor = detailColor</div><div class="line">        <span class="keyword">self</span>.detailFont = detailFont</div><div class="line">        <span class="keyword">self</span>.accessory = accessory</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CellStyle</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">var</span> settings: <span class="type">CellStyle</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">CellStyle</span>(labelColor: .purple(),</div><div class="line">                         labelFont: .preferredFont(forTextStyle: <span class="type">UIFontTextStyleTitle1</span>),</div><div class="line">                         detailColor: .green(),</div><div class="line">                         detailFont: .preferredFont(forTextStyle: <span class="type">UIFontTextStyleCaption1</span>),</div><div class="line">                         accessory: <span class="type">UIImage</span>(named: <span class="string">"checkmark"</span>)!)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CellStyle</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">var</span> custom: <span class="type">CellStyle</span> &#123;</div><div class="line">        <span class="comment">// uses default fonts</span></div><div class="line">        <span class="keyword">return</span> <span class="type">CellStyle</span>(labelColor: .blue(),</div><div class="line">                         detailColor: .red(),</div><div class="line">                         accessory: <span class="type">UIImage</span>(named: <span class="string">"action"</span>)!)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonTableCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">apply</span><span class="params">(style: CellStyle)</span></span> &#123;</div><div class="line">        textLabel?.textColor = style.labelColor</div><div class="line">        textLabel?.font = style.labelFont</div><div class="line"></div><div class="line">        detailTextLabel?.textColor = style.detailColor</div><div class="line">        detailTextLabel?.font = style.detailFont</div><div class="line"></div><div class="line">        accessoryView = <span class="type">UIImageView</span>(image: style.accessory)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// usage:</span></div><div class="line">cell.apply(style: .settings)</div></pre></td></tr></table></figure>
<p>对扩展开放，对修改关闭</p>
<blockquote>
<p>Software entities should be open for extension, but closed for modification. That is, such an entity can allow its behavior to be extended without modifying its source code.</p>
</blockquote>
<div text-align="center"><br><img src="http://obp26pczx.bkt.clouddn.com/cell-model.png" width="80%"><br></div>


<h3 id="扩展阅读："><a href="#扩展阅读：" class="headerlink" title="扩展阅读："></a>扩展阅读：</h3><ul>
<li><a href="http://www.jessesquires.com/enums-as-configs/?utm_campaign=This%2BWeek%2Bin%2BSwift&amp;utm_medium=web&amp;utm_source=This_Week_in_Swift_98" target="_blank" rel="noopener">Enums as configuration: the anti-pattern</a></li>
<li><a href="https://realm.io/cn/news/tryswift-daniel-steinberg-blending-cultures/" target="_blank" rel="noopener">文化碰撞：函数式、面向协议、面向对象编程的最佳实践</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/08/07/私有 Cocoapods 的创建和维护/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/07/私有 Cocoapods 的创建和维护/" itemprop="url">私有 Cocoapods 的创建和维护</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-07T21:53:39+08:00">
                2016-08-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/07/私有 Cocoapods 的创建和维护/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/08/07/私有 Cocoapods 的创建和维护/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/08/07/私有 Cocoapods 的创建和维护/" class="leancloud_visitors" data-flag-title="私有 Cocoapods 的创建和维护">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="使用cocoapods创建私有podspec"><a href="#使用cocoapods创建私有podspec" class="headerlink" title="使用cocoapods创建私有podspec"></a>使用cocoapods创建私有<code>podspec</code></h3><h4 id="创建私有podspec的步骤"><a href="#创建私有podspec的步骤" class="headerlink" title="创建私有podspec的步骤"></a>创建私有<code>podspec</code>的步骤</h4><h5 id="1-创建并设置一个私有的Spec-Repo"><a href="#1-创建并设置一个私有的Spec-Repo" class="headerlink" title="1. 创建并设置一个私有的Spec Repo"></a>1. 创建并设置一个私有的<code>Spec Repo</code></h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod repo add MySpecs <span class="symbol">https:</span>/<span class="regexp">/gitlab.com/oheroj</span><span class="regexp">/spects.git</span></div></pre></td></tr></table></figure>
<p>验证是否成功的话，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~/.cocoapods/repos/MySpecs</div></pre></td></tr></table></figure></p>
<p><img src="/images/pod-file01.png" alt="eg"></p>
<h5 id="2-创建Pod所需要的项目工程文件，-并且有可访问的项目版本控制地址"><a href="#2-创建Pod所需要的项目工程文件，-并且有可访问的项目版本控制地址" class="headerlink" title="2. 创建Pod所需要的项目工程文件， 并且有可访问的项目版本控制地址"></a>2. 创建Pod所需要的项目工程文件， 并且有可访问的项目版本控制地址</h5><h5 id="3-创建Pod所对应的podspec文件"><a href="#3-创建Pod所对应的podspec文件" class="headerlink" title="3. 创建Pod所对应的podspec文件"></a>3. 创建Pod所对应的<code>podspec</code>文件</h5><p>一般情况下2，3 两步骤是在一起的， 使用<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib create RoundButton</div></pre></td></tr></table></figure></p>
<p><img src="/images/pod-file02.png" alt="pod lib create eg"></p>
<p><img src="/images/pod-file03.png" alt="pod lib create xocde eg"></p>
<p>接下来就是在pod文件夹中添加文件和资源， 并配置<code>podspec</code>文件。</p>
<p><img src="/images/pod-file04.png" alt="pod lib create xcode add"></p>
<p>将代码推送到远端：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git add .</div><div class="line">git commit <span class="_">-s</span> -m <span class="string">"First Commit of Lib"</span></div></pre></td></tr></table></figure>
<p>这个时候你在gitlab上创建个项目：<br><img src="/images/pod-file05.png" alt="pod lib create xcode gitlab"></p>
<p>将本地代码库与远程代码库关联<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git remote add origin git@gitlab.com:oheroj/RoundButton.git <span class="comment">#添加远端仓库</span></div><div class="line">git push origin master <span class="comment"># 提交到远端仓库</span></div></pre></td></tr></table></figure></p>
<p>这里我们也会遇到一个问题就是 git 提交人的信息有问题，默认提交者为你设置的全局的git的ueser， 所以这个时候就得改名字了， 比如我这边要改为 oheroj , 然后邮箱改为gmail邮箱。<br>有这么一段脚本可以 <a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2" target="_blank" rel="noopener">参考执行</a>：</p>
<p>有这么个脚本  change.sh, 里面的内容是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">git filter-branch --env-filter <span class="string">'</span></div><div class="line"></div><div class="line">OLD_EMAIL="1814345797@qq.com"</div><div class="line">CORRECT_NAME="OHeroJ"</div><div class="line">CORRECT_EMAIL="oheroj@gmail.com"</div><div class="line"></div><div class="line">if [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]</div><div class="line">then</div><div class="line">    export GIT_COMMITTER_NAME="$CORRECT_NAME"</div><div class="line">    export GIT_COMMITTER_EMAIL="$CORRECT_EMAIL"</div><div class="line">fi</div><div class="line">if [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]</div><div class="line">then</div><div class="line">    export GIT_AUTHOR_NAME="$CORRECT_NAME"</div><div class="line">    export GIT_AUTHOR_EMAIL="$CORRECT_EMAIL"</div><div class="line">fi</div><div class="line">' --tag-name-filter cat -- --branches --tags</div></pre></td></tr></table></figure>
<p>这个时候你直接替换相应的内容，然后执行 <code>sh change.sh</code></p>
<blockquote>
<p>这里需要注意的是每当你向Pod中添加了新的文件或者以后更新了podspec的版本都需要重新执行一遍pod update命令</p>
</blockquote>
<p>接下来就是编辑<code>podspec</code>文件了, 涉及到的字段可以到 <a href="http://guides.cocoapods.org/syntax/podspec.html#specification" target="_blank" rel="noopener">官方文档</a> 查阅<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Pod::Spec.new <span class="keyword">do</span> <span class="params">|s|</span></div><div class="line">  s.name             = <span class="string">'RoundButton'</span></div><div class="line">  s.version          = <span class="string">'0.1.0'</span></div><div class="line">  s.summary          = <span class="string">'A Custom Round Button of Button.'</span></div><div class="line"></div><div class="line"><span class="comment"># This description is used to generate tags and improve search results.</span></div><div class="line"><span class="comment">#   * Think: What does it do? Why did you write it? What is the focus?</span></div><div class="line"><span class="comment">#   * Try to keep it short, snappy and to the point.</span></div><div class="line"><span class="comment">#   * Write the description between the DESC delimiters below.</span></div><div class="line"><span class="comment">#   * Finally, don't worry about the indent, CocoaPods strips it!</span></div><div class="line"></div><div class="line">  s.description      = <span class="string">&lt;&lt;-DESC</span></div><div class="line">创建一个带有圆角的UIButton, 并且用block封装回调</div><div class="line">                       DESC</div><div class="line"></div><div class="line">  s.homepage         = <span class="string">'https://gitlab.com/oheroj/RoundButton'</span></div><div class="line">  <span class="comment"># s.screenshots     = 'www.example.com/screenshots_1', 'www.example.com/screenshots_2'</span></div><div class="line">  s.license          = &#123; <span class="symbol">:type</span> =&gt; <span class="string">'MIT'</span>, <span class="symbol">:file</span> =&gt; <span class="string">'LICENSE'</span> &#125;</div><div class="line">  s.author           = &#123; <span class="string">'oheroj'</span> =&gt; <span class="string">'oheroj@gmail.com'</span> &#125;</div><div class="line">  s.source           = &#123; <span class="symbol">:git</span> =&gt; <span class="string">'https://gitlab.com/oheroj/RoundButton.git'</span>, <span class="symbol">:tag</span> =&gt; s.version.to_s &#125;</div><div class="line">  <span class="comment"># s.social_media_url = 'https://twitter.com/&lt;TWITTER_USERNAME&gt;'</span></div><div class="line"></div><div class="line">  s.ios.deployment_target = <span class="string">'8.0'</span></div><div class="line"></div><div class="line">  s.source_files = <span class="string">'RoundButton/Classes/**/*'</span></div><div class="line"></div><div class="line">  <span class="comment"># s.resource_bundles = &#123;</span></div><div class="line">  <span class="comment">#   'RoundButton' =&gt; ['RoundButton/Assets/*.png']</span></div><div class="line">  <span class="comment"># &#125;</span></div><div class="line"></div><div class="line">  <span class="comment"># s.public_header_files = 'Pod/Classes/**/*.h'</span></div><div class="line">  <span class="comment"># s.frameworks = 'UIKit', 'MapKit'</span></div><div class="line">  <span class="comment"># s.dependency 'AFNetworking', '~&gt; 2.3'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>进行提交，并且打<code>tag</code></p>
<blockquote>
<p>因为podspec文件中获取Git版本控制的项目还需要tag号，所以我们要打上一个tag</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git commit -a -m &quot;podspec modif&quot;</div><div class="line">git push origin master</div><div class="line"></div><div class="line">git tag -m &quot;first release&quot; 0.1.0</div><div class="line">git push --tags</div></pre></td></tr></table></figure>
<h5 id="4-本地测试配置好的podsepc文件是否可用"><a href="#4-本地测试配置好的podsepc文件是否可用" class="headerlink" title="4. 本地测试配置好的podsepc文件是否可用"></a>4. 本地测试配置好的<code>podsepc</code>文件是否可用</h5><p>编辑完<code>podspec</code>文件后，需要验证一下这个文件是否可用，如果有任何WARNING或者ERROR都是不可以的，它就不能被添加到Spec Repo中，不过xcode的WARNING是可以存在的，验证需要执行一下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib lint</div></pre></td></tr></table></figure>
<p><img src="/images/pod-file06.png" alt="pod lib lint"></p>
<h6 id="创建podspec-文件-此步骤是对有现存项目的"><a href="#创建podspec-文件-此步骤是对有现存项目的" class="headerlink" title="创建podspec 文件(此步骤是对有现存项目的)"></a>创建podspec 文件(此步骤是对有现存项目的)</h6><p>如果有现成项目的话， 我们就需要给这个项目创建个<code>podspec</code>文件,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod sepc create RoundButton git@gitlab.com:oheroj/RoundButton.git</div></pre></td></tr></table></figure></p>
<p>执行完之后，就创建了一个podspec文件，他其中会包含很多内容，可以按照我之前介绍的进行编辑，没用的删掉。编辑完成之后使用验证命令验证一下.</p>
<h5 id="5-向私有的Spec-Repo-中提交-podsepc"><a href="#5-向私有的Spec-Repo-中提交-podsepc" class="headerlink" title="5. 向私有的Spec Repo 中提交 podsepc"></a>5. 向私有的<code>Spec Repo</code> 中提交 podsepc</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod repo push MySpecs RoundButton.podspec</div></pre></td></tr></table></figure>
<p><img src="/images/pod-file07.png" alt="pod repos push "></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod search RoundButton</div></pre></td></tr></table></figure>
<p><img src="/images/pod-file08.png" alt="pod search"></p>
<h5 id="6-在个人项目中的Podfile中增加刚刚制作好的Pod使用"><a href="#6-在个人项目中的Podfile中增加刚刚制作好的Pod使用" class="headerlink" title="6. 在个人项目中的Podfile中增加刚刚制作好的Pod使用"></a>6. 在个人项目中的<code>Podfile</code>中增加刚刚制作好的<code>Pod</code>使用</h5><p>在其他项目中使用的时候, 在podfile中添加如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">source <span class="string">'https://github.com/CocoaPods/Specs.git'</span> <span class="comment">#公有库</span></div><div class="line">source <span class="string">'https://gitlab.com/oheroj/spects.git'</span></div><div class="line"></div><div class="line">platform <span class="symbol">:ios</span>, <span class="string">"8.0"</span></div><div class="line"></div><div class="line">target <span class="string">'ModelPro'</span> <span class="keyword">do</span></div><div class="line">    pod <span class="string">'RoundButton'</span>, <span class="string">'~&gt; 0.1.0'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>然后执行pod install 即可</p>
<h5 id="7-更新维护podspec"><a href="#7-更新维护podspec" class="headerlink" title="7. 更新维护podspec"></a>7. 更新维护<code>podspec</code></h5><h5 id="版本规范（版本tag）"><a href="#版本规范（版本tag）" class="headerlink" title="版本规范（版本tag）"></a>版本规范（版本tag）</h5><p><strong>major.minor.patch</strong></p>
<p>App主项目依赖  <code>pod &#39;AFNetworking&#39;, &#39;~&gt; 3.1.0&#39;</code></p>
<ul>
<li>修改bug和一些其他不重要修改（修改README，Format等），增加patch版本号。用户可以放心升级。</li>
<li>曾加功能并且向前兼容，增加minor版本号。用户可以考虑升级。（推荐升级）</li>
<li>不向前兼容或重大修改或重构，增加major版本号。用户应当慎重决定是否升级。</li>
<li>当major为0时，表示该库为beta版本。不是稳定版本，所以会经常修改，并很容易造成向前不兼容的情况。开发者需要认真评估major版本号。 此时发生向前不兼容的情况，开发者应当升级minor版本号。其他同上面的规范。</li>
</ul>
<h5 id="维护、增加新功能"><a href="#维护、增加新功能" class="headerlink" title="维护、增加新功能"></a>维护、增加新功能</h5><p>将源文件添加到<code>Pod/Classes</code>中， 在测试项目里<code>pod update</code>一下， 写代码验证无误之后，就可以将这个工程 <code>push</code> 到远端仓库， 并且打上新的 tag， tag 号遵从上面的版本规范来制定。</p>
<p>然后修改<code>podspec</code>上的<code>s.version</code>为我们的 tag 号。最后再次使用<code>pod lib lint</code>验证编辑好的<code>podsepc</code>文件，没有自身的WARNING或者ERROR之后，就可以再次提交到Spec Repo中了，命令跟之前是一样的</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod repo push MySpecs RoundButton.podspec</div></pre></td></tr></table></figure>
<p>之后再次到~/.cocoapods/repos/MySpecs目录下查看, eg:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── YTNSFoundation</div><div class="line">│   └── 0.1.0</div><div class="line">│       └── YTNSFoundation.podspec</div><div class="line">├── YTNetworking</div><div class="line">│   └── 1.0.12</div><div class="line">│       └── YTNetworking.podspec</div><div class="line">└── YTUIKit</div><div class="line">    ├── 0.1.0</div><div class="line">    │   └── YTUIKit.podspec</div><div class="line">    └── 0.1.1</div><div class="line">        └── YTUIKit.podspec</div></pre></td></tr></table></figure>
<h5 id="删除本地一个私有Spec-Repo"><a href="#删除本地一个私有Spec-Repo" class="headerlink" title="删除本地一个私有Spec Repo"></a>删除本地一个私有<code>Spec Repo</code></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod repo remove WTSpecs</div></pre></td></tr></table></figure>
<h5 id="删除私有Spec-Repo某一个podspec"><a href="#删除私有Spec-Repo某一个podspec" class="headerlink" title="删除私有Spec Repo某一个podspec"></a>删除私有<code>Spec Repo</code>某一个<code>podspec</code></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd ~/.cocoapods/repos/MySpecs</div><div class="line">rm -rf RoundButton</div><div class="line">git commit -a -m &quot;Feat: RoundButton podspec&quot;</div><div class="line">git push origin master</div></pre></td></tr></table></figure>
<h5 id="8-参考文献"><a href="#8-参考文献" class="headerlink" title="8. 参考文献"></a>8. 参考文献</h5><ol>
<li><a href="http://guides.cocoapods.org/making/private-cocoapods.html" target="_blank" rel="noopener">Private Pods</a></li>
<li><a href="http://blog.grio.com/2014/11/creating-a-private-cocoapod.html" target="_blank" rel="noopener">Creating a Private CocoaPod</a></li>
<li><a href="https://objectpartners.com/2014/06/25/developing-private-in-house-libraries-with-cocoapods/" target="_blank" rel="noopener">Developing Private In-House Libraries with CocoaPods</a></li>
<li><a href="http://blog.wtlucky.com/blog/2015/02/26/create-private-podspec/" target="_blank" rel="noopener">使用Cocoapods创建私有podspec</a></li>
<li><a href="http://www.pluto-y.com/cocoapod-private-pods-and-module-manager/" target="_blank" rel="noopener">Cocoapods系列教程(三)——私有库管理和模块化管理</a></li>
<li><a href="http://xiongzenghuidegithub.github.io/blog/2015/12/25/frameworksan-,-shi-yong-di-san-ku/" target="_blank" rel="noopener">一个iOS菜菜的白话文记录</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/07/28/自定义 Xcode 模板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/28/自定义 Xcode 模板/" itemprop="url">自定义 Xcode 模板</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-28T22:52:23+08:00">
                2016-07-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/28/自定义 Xcode 模板/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/07/28/自定义 Xcode 模板/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/28/自定义 Xcode 模板/" class="leancloud_visitors" data-flag-title="自定义 Xcode 模板">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>很多时候，我们为了阅读、快速查询代码用的手段就是在写代码的时候 使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#pragma mark -</div><div class="line">#pragma mark</div><div class="line">....</div></pre></td></tr></table></figure></p>
<p>这些来对代码进行分区块标注， 这是个很不错的开发习惯。</p>
<p>但是往往有些东西重复多了，感觉就是在浪费时间:</p>
<p>比如 在<code>ViewController</code>我们基本上都会有如下的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">#pragma mark - life cycle</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - api</div><div class="line"></div><div class="line">#pragma mark - delegate</div><div class="line"></div><div class="line">#pragma mark - dataSource</div><div class="line"></div><div class="line">#pragma mark - netWork</div><div class="line"></div><div class="line">#pragma mark - event response</div><div class="line"></div><div class="line">#pragma mark - private methods</div><div class="line"></div><div class="line">#pragma mark - getter / setter</div></pre></td></tr></table></figure>
<p>在 <code>View</code>上我们会有如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#pragma mark - initial</div><div class="line"></div><div class="line">#pragma mark - add subviews (setup)</div><div class="line">- (void)setup &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line">#pragma mark - view layouts</div><div class="line">- (void)layoutUI &#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - public method</div><div class="line"></div><div class="line">#pragma mark - private method</div><div class="line"></div><div class="line"></div><div class="line">#pragma mark - getter / setter</div><div class="line"></div><div class="line"></div><div class="line">#pragma mark - config test data</div></pre></td></tr></table></figure></p>
<blockquote>
<p>事情可以重复1遍，2遍，但是如果要重复3遍，那就必须得重构了</p>
</blockquote>
<p>所以我们有没有办法解决这个问题呢？ 答案当然是显然的。 在我们创建一个UITableViewController 的时候，你会发现.m里面会生成一些默认代码，那么 我们能否制作一份呢， 要怎么做？</p>
<h3 id="can-do-how-do"><a href="#can-do-how-do" class="headerlink" title="can do ? how do?"></a>can do ? how do?</h3><h5 id="1-这些文件到底是从哪里生成的？"><a href="#1-这些文件到底是从哪里生成的？" class="headerlink" title="1. 这些文件到底是从哪里生成的？"></a>1. 这些文件到底是从哪里生成的？</h5><p>如果做过php, 或者python的同学 应该知道<code>模板引擎</code>, 其实xcode 生成的原理也差不多，有一份模板文件，这些文件放在叫一个<code>templates</code>的文件目录下(<code>xcode7.3</code>)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/</div></pre></td></tr></table></figure></p>
<p>我们可以切换到这个目录：<br><img src="/images/ddtemplate.png" alt="templates"></p>
<p><code>Templates</code>下的目录结构我就不再这多说了，我相信你有这种能力发现一些规律:<br><img src="/images/ddxcode.png" alt="xcode"></p>
<p>可以对比上面的两个图， 你会看到那个<code>牛头</code>的图标在上面的两张图中都有体现。</p>
<h5 id="2-那么ViewController-xctemplate-里面放的是什么？"><a href="#2-那么ViewController-xctemplate-里面放的是什么？" class="headerlink" title="2. 那么ViewController.xctemplate 里面放的是什么？"></a>2. 那么<code>ViewController.xctemplate</code> 里面放的是什么？</h5><ol>
<li>Templatelcon.png 就是一个图标， 这东西你可以随意换，就是不要把这名字给换了</li>
<li><p>Templatelcon.plist里面是一些配置的东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</div><div class="line">&lt;plist version=&quot;1.0&quot;&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">	&lt;key&gt;AllowedTypes&lt;/key&gt;</div><div class="line">	&lt;array&gt;</div><div class="line">		&lt;string&gt;public.objective-c-source&lt;/string&gt;</div><div class="line">		&lt;string&gt;public.objective-c-plus-plus-source&lt;/string&gt;</div><div class="line">	&lt;/array&gt;</div><div class="line">	&lt;key&gt;DefaultCompletionName&lt;/key&gt;</div><div class="line">	&lt;string&gt;File&lt;/string&gt;</div><div class="line">	&lt;key&gt;Description&lt;/key&gt;</div><div class="line">	&lt;string&gt;自定义 viewController 模板&lt;/string&gt;</div><div class="line">	&lt;key&gt;Kind&lt;/key&gt;</div><div class="line">	&lt;string&gt;Xcode.IDEKit.TextSubstitutionFileTemplateKind&lt;/string&gt;</div><div class="line">	&lt;key&gt;Options&lt;/key&gt;</div><div class="line">	&lt;array&gt;</div><div class="line">		&lt;dict&gt;</div><div class="line">			&lt;key&gt;Description&lt;/key&gt;</div><div class="line">			&lt;string&gt;The name of the file to create&lt;/string&gt;</div><div class="line">			&lt;key&gt;Identifier&lt;/key&gt;</div><div class="line">			&lt;string&gt;productName&lt;/string&gt;</div><div class="line">			&lt;key&gt;Name&lt;/key&gt;</div><div class="line">			&lt;string&gt;File:&lt;/string&gt;</div><div class="line">			&lt;key&gt;NotPersisted&lt;/key&gt;</div><div class="line">			&lt;true/&gt;</div><div class="line">			&lt;key&gt;Required&lt;/key&gt;</div><div class="line">			&lt;true/&gt;</div><div class="line">			&lt;key&gt;Type&lt;/key&gt;</div><div class="line">			&lt;string&gt;text&lt;/string&gt;</div><div class="line">		&lt;/dict&gt;</div><div class="line">		&lt;dict&gt;</div><div class="line">			&lt;key&gt;Default&lt;/key&gt;</div><div class="line">			&lt;string&gt;UIViewController&lt;/string&gt;</div><div class="line">			&lt;key&gt;Description&lt;/key&gt;</div><div class="line">			&lt;string&gt;What class to subclass in the new file&lt;/string&gt;</div><div class="line">			&lt;key&gt;FallbackHeader&lt;/key&gt;</div><div class="line">			&lt;string&gt;#import &amp;lt;UIKit/UIKit.h&amp;gt;&lt;/string&gt;</div><div class="line">			&lt;key&gt;Identifier&lt;/key&gt;</div><div class="line">			&lt;string&gt;cocoaSubclass&lt;/string&gt;</div><div class="line">			&lt;key&gt;Name&lt;/key&gt;</div><div class="line">			&lt;string&gt;Subclass of:&lt;/string&gt;</div><div class="line">			&lt;key&gt;Required&lt;/key&gt;</div><div class="line">			&lt;true/&gt;</div><div class="line">			&lt;key&gt;Type&lt;/key&gt;</div><div class="line">			&lt;string&gt;class&lt;/string&gt;</div><div class="line">			&lt;key&gt;Values&lt;/key&gt;</div><div class="line">			&lt;array&gt;</div><div class="line">				&lt;string&gt;UIViewController&lt;/string&gt;</div><div class="line">			&lt;/array&gt;</div><div class="line">		&lt;/dict&gt;</div><div class="line">	&lt;/array&gt;</div><div class="line">	&lt;key&gt;SortOrder&lt;/key&gt;</div><div class="line">	&lt;string&gt;4&lt;/string&gt;</div><div class="line">	&lt;key&gt;Summary&lt;/key&gt;</div><div class="line">	&lt;string&gt;自定义 viewController 模板&lt;/string&gt;</div><div class="line">&lt;/dict&gt;</div><div class="line">&lt;/plist&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>UIViewController 这文件夹的东西你可以对比 Source文件下的系统默认的</p>
</li>
</ol>
<p>在<code>__FILEBASENAME__.H</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">//  ___FILEBASENAME___.h</div><div class="line">//  ___PROJECTNAME___</div><div class="line">//</div><div class="line">//  Created by ___FULLUSERNAME___ on ___DATE___.</div><div class="line">//___COPYRIGHT___</div><div class="line">//</div><div class="line"></div><div class="line">___IMPORTHEADER_cocoaSubclass___</div><div class="line"></div><div class="line">@interface ___FILEBASENAME___: ___VARIABLE_cocoaSubclass___</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure></p>
<p>在 <code>__FILEBASENAME__.m</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">//  ___FILEBASENAME___.m</div><div class="line">//  ___PROJECTNAME___e</div><div class="line">//</div><div class="line">//  Created by ___FULLUSERNAME___ on ___DATE___.</div><div class="line">//___COPYRIGHT___</div><div class="line">//</div><div class="line"></div><div class="line">#import &quot;___FILEBASENAME___.h&quot;</div><div class="line"></div><div class="line">@interface ___FILEBASENAME___ ()</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation ___FILEBASENAME___</div><div class="line"></div><div class="line">#pragma mark - life cycle</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark - api</div><div class="line"></div><div class="line">#pragma mark - delegate</div><div class="line"></div><div class="line">#pragma mark - dataSource</div><div class="line"></div><div class="line">#pragma mark - netWork</div><div class="line"></div><div class="line">#pragma mark - event response</div><div class="line"></div><div class="line">#pragma mark - private methods</div><div class="line"></div><div class="line">#pragma mark - getter / setter</div><div class="line"></div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>然后打开一个xcode项目， cmd + n</p>
<p>然后很多你想要的就有了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/07/24/Gitlab 之 Gitbook 自动集成/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/24/Gitlab 之 Gitbook 自动集成/" itemprop="url">Gitlab 之 Gitbook 自动集成</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-24T22:21:38+08:00">
                2016-07-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/24/Gitlab 之 Gitbook 自动集成/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/07/24/Gitlab 之 Gitbook 自动集成/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/24/Gitlab 之 Gitbook 自动集成/" class="leancloud_visitors" data-flag-title="Gitlab 之 Gitbook 自动集成">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近有个任务是 想通过 <code>gitlab</code> 的 CI 来管理 API 文档，很多时候我们都可以在 gitbook 上看到有很多人写书，<br>排版使用 markdown, 个人钟爱 markdown, 在这个任务之前，鄙人没有接触过 gitlab, 接触过一段时间，感觉杠杠的，<br>很喜欢这个它的持续化集成的功能，然后还有可以免费创建私有仓库。</p>
</blockquote>
<p>今天植入主题，我们该如何在 <strong>gitlab</strong> 上持续集成我们的 <strong>gitbook</strong> 文档。</p>
<h3 id="为什么需要文档？"><a href="#为什么需要文档？" class="headerlink" title="为什么需要文档？"></a>为什么需要文档？</h3><p>个人觉得：</p>
<ol>
<li>如果是新人入职的话，有文档那很多东西就方便多了；</li>
<li>开发一个组件，写出文档，很多东西就不需要重复介绍给使用的人</li>
<li>降低沟通成本和维护成本</li>
<li>提高开发效率</li>
<li>可以把一个新技术的探研做成一份学习路线文档，这样后来人就可以减少学习的成本</li>
</ol>
<h3 id="需要的工具"><a href="#需要的工具" class="headerlink" title="需要的工具"></a>需要的工具</h3><ol>
<li><a href="https://www.sourcetreeapp.com" target="_blank" rel="noopener">SourceTree</a></li>
<li><a href="https://www.gitbook.com/editor/" target="_blank" rel="noopener">GitBookEditor</a></li>
<li><a href="https://github.com/GitbookIO/gitbook/blob/master/docs/setup.md" target="_blank" rel="noopener">GitBook</a></li>
</ol>
<h3 id="文档编写-markdown"><a href="#文档编写-markdown" class="headerlink" title="文档编写 markdown"></a>文档编写 <code>markdown</code></h3><p>语法可 <a href="http://www.jianshu.com/p/q81RER" target="_blank" rel="noopener">参考</a></p>
<h3 id="gitbook-基本使用"><a href="#gitbook-基本使用" class="headerlink" title="gitbook 基本使用"></a><code>gitbook</code> 基本使用</h3><p>使用可 <a href="http://www.chengweiyang.cn/gitbook/basic-usage/README.html" target="_blank" rel="noopener">参考</a></p>
<h3 id="gitlab上持续集成的步骤"><a href="#gitlab上持续集成的步骤" class="headerlink" title="gitlab上持续集成的步骤"></a><code>gitlab</code>上持续集成的步骤</h3><ol>
<li>在gitlab新建一个resposity</li>
<li>checkout到本地</li>
<li>在项目上新增一个 .gitlab-ci.yml 文件 并提交到 Gitlab</li>
</ol>
<h3 id="gitlab-的-gitlab-ci-yml文件的编写"><a href="#gitlab-的-gitlab-ci-yml文件的编写" class="headerlink" title="gitlab 的 .gitlab-ci.yml文件的编写"></a><code>gitlab</code> 的 <code>.gitlab-ci.yml</code>文件的编写</h3><ol>
<li><a href="http://docs.gitlab.com/ce/ci/yaml/README.html" target="_blank" rel="noopener">.gitlab-ci.yml 指南</a></li>
<li><p>文件参考书写：</p>
<pre><code>before_script:
- env
- export LC_ALL=zh_TW.UTF-8

stages:
- build

ebook:
stage: build
script:
- gitbook pdf
artifacts:
paths:
  - book.pdf
only:
- master

image: shuoshuo/gitbook-builder:latest
</code></pre></li>
</ol>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li><a href="http://www.jianshu.com/p/e650aac83f7a" target="_blank" rel="noopener">gitbook在私有gitlab上持续集成</a></li>
<li><p><a href="http://docs.gitlab.com/ce/ci/yaml/README.html" target="_blank" rel="noopener">Configuration of your builds with .gitlab-ci.yml</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/q81RER" target="_blank" rel="noopener">献给写作者的 Markdown 新手指南</a></p>
</li>
<li><a href="http://www.jianshu.com/p/168c0c1c7e4f" target="_blank" rel="noopener">敏捷开发之API管理之道</a></li>
<li><a href="http://www.jianshu.com/p/2b43151fb92e/comments/2348175" target="_blank" rel="noopener">GitLab-CI与GitLab-Runner</a></li>
<li><a href="https://yudachi.biz/2016/05/27/moving-to-gitlab-pages/" target="_blank" rel="noopener">基地转移！从 GitHub Pages 转移到 GitLab Pages</a></li>
<li><a href="https://medium.com/@shuoshuo/多人共筆且自動產生-pdf-版電子書-5a0f1053c069#.8qic6kquk" target="_blank" rel="noopener">多人共筆且自動產生 PDF 版電子書</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/07/16/iOS 之 Cocoapods/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/16/iOS 之 Cocoapods/" itemprop="url">iOS 之 Cocoapods</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-16T07:06:01+08:00">
                2016-07-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/16/iOS 之 Cocoapods/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/07/16/iOS 之 Cocoapods/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/16/iOS 之 Cocoapods/" class="leancloud_visitors" data-flag-title="iOS 之 Cocoapods">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>很多东西就不在此啰嗦了， 根据 <a href="http://blog.devtang.com/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/" target="_blank" rel="noopener">这篇博客</a> 就可以很愉快的玩上你的cocoapods了</p>
</blockquote>
<p>今天想说的是关于自己在使用上遇到的一些问题：</p>
<h3 id="1-cocoapods-重装问题"><a href="#1-cocoapods-重装问题" class="headerlink" title="1. cocoapods 重装问题"></a>1. cocoapods 重装问题</h3><h4 id="1-卸载"><a href="#1-卸载" class="headerlink" title="1. 卸载"></a>1. 卸载</h4><pre><code>sudo gem uninstall cocoapods

// 你也可以卸载指定版本的cocoapods
// sudo gem uninstall cocoapods -v 0.38

// 对于如何查看你安装的版本
// gem list
</code></pre><h4 id="2-重装"><a href="#2-重装" class="headerlink" title="2. 重装"></a>2. 重装</h4><pre><code>// 检测你安装的 ruby 的版本是否是该 cocoapods 所支持的
sudo gem update --system
sudo gem install cocoapods
// 或者安装指定版本的
// sudo gem install cocoapods -v 1.0.0
</code></pre><h4 id="3-pod-setup"><a href="#3-pod-setup" class="headerlink" title="3. pod setup"></a>3. pod setup</h4><p>这块拎出来讲是有原因的， 主要是在执行上面的 1，2 其实很关键的就是这个 setup 这步，很多东西都依赖于这个。</p>
<p>那么这部做了什么东西？</p>
<pre><code>cd ~/.cocoapods/repos/
</code></pre><p>会有个 <code>master</code> 文件夹，那么这个文件夹的东西就是这个 <code>pod setup</code>生成的。对于这个我们在每次<code>pod install or pod update</code> 的时候，也会牵扯到这个文件夹中的内容。</p>
<pre><code>// 切刀这个 ~/.cocoapods/repos/
du -sh *

// 我这边显示的结果是
779M  master
</code></pre><p>779M， 这也是为什么 pod setup 这么慢的原因吧(所以在setup 的时候最好是能在比较稳定且快速的网络下进行， 我就因为公司的网络问题， 下了n便，结果没成功)。</p>
<p>那么如果我们就是 setup 不成功， 那么这个时候我们可以另寻其他的路：我们可以向朋友叫他们 zip 出这个包给你,然后放到这个目录下就好。</p>
<h4 id="4-可能会有的坑"><a href="#4-可能会有的坑" class="headerlink" title="4. 可能会有的坑"></a>4. 可能会有的坑</h4><h5 id="1-搜索时报错"><a href="#1-搜索时报错" class="headerlink" title="1. 搜索时报错"></a>1. 搜索时报错</h5><pre><code>pod search  AFNetworking
</code></pre><p>出现了 <code>[!] Unable to find a pod with name, author, summary, or descriptionmatching</code>AFNetworking``</p>
<p>解决方案是：</p>
<pre><code>rm ~/Library/Caches/CocoaPods/search_index.json

// 然后
pod search AFNetworking
</code></pre><h5 id="2-1-0以上的版本-记得设置-target"><a href="#2-1-0以上的版本-记得设置-target" class="headerlink" title="2. 1.0以上的版本  记得设置 target"></a>2. 1.0以上的版本  记得设置 target</h5><h5 id="3-pod-install-或者-pod-update-很慢"><a href="#3-pod-install-或者-pod-update-很慢" class="headerlink" title="3. pod install 或者 pod update 很慢"></a>3. pod install 或者 pod update 很慢</h5><pre><code>pod install --verbose --no-repo-update
pod update --verbose --no-repo-update
</code></pre><p>原因在于当执行以上两个命令的时候会升级CocoaPods的spec仓库，加一个参数可以省略这一步，然后速度就会提升不少</p>
<h4 id="5-参考"><a href="#5-参考" class="headerlink" title="5. 参考"></a>5. 参考</h4><ol>
<li><a href="http://blog.devtang.com/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/" target="_blank" rel="noopener">用CocoaPods做iOS程序的依赖管理</a></li>
<li><a href="https://segmentfault.com/a/1190000005011497" target="_blank" rel="noopener">拥抱 CocoaPods 1.0</a></li>
<li><a href="http://www.jianshu.com/p/f79589c21dc4" target="_blank" rel="noopener">Cocoapods安装使用以及完全卸载</a></li>
<li><a href="http://my.oschina.net/u/2559341/blog/592738#OSC_h3_10" target="_blank" rel="noopener">CocoaPods详解之—-使用篇 pod install/pod update更新慢的问题</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/07/10/Swift 之后台 Vapor 初步/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/10/Swift 之后台 Vapor 初步/" itemprop="url">Swift 之后台 Vapor 初步</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-10T17:27:32+08:00">
                2016-07-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/10/Swift 之后台 Vapor 初步/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/07/10/Swift 之后台 Vapor 初步/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/10/Swift 之后台 Vapor 初步/" class="leancloud_visitors" data-flag-title="Swift 之后台 Vapor 初步">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>近日，发现Vapor相应功能都基本完工了。之前的早期版本自己也尝试过，感觉这个库很符合自己的口味。早期vapor定位是swift版的Laravel.正如它自己描写<br>“Vapor is the first true web framework for Swift. It provides a beautifully expressive and easy to use foundation for your next website or API.”<br>如果使用PHP Laravel的同学应该知道，这个库的很有艺术性，很优美<br>“The PHP Framework For Web Artisans”<br>swift的年轻所以有很多地方也造就了vapor的年轻<br>所以在使用vapor的时候并不是那么方便，坑还是不少的。</p>
</blockquote>
<hr>
<p>环境：  xcode7.3.1  macOS 10.11.6</p>
<h3 id="swift-版本的选择"><a href="#swift-版本的选择" class="headerlink" title="swift 版本的选择"></a>swift 版本的选择</h3><p>对于这个问题，我想说用swiftenv来解决吧</p>
<pre><code>brew install kylef/formulae/swiftenv
</code></pre><h3 id="vapor-CLI的安装"><a href="#vapor-CLI的安装" class="headerlink" title="vapor CLI的安装"></a>vapor CLI的安装</h3><pre><code>curl -L cli.qutheory.io -o vapor
chmod +x vapor
sudo mv vapor /usr/local/bin
</code></pre><h3 id="vapor"><a href="#vapor" class="headerlink" title="vapor"></a>vapor</h3><p>如果你想使用vapor 的demo的话，直接用<code>vapor new yourDemo</code>, 这个时候你的项目就不是纯净的，当然可能会引发出相关问题，我这边碰到的是 ， vapor CLI的版本是5.3, 这个版本对应的swift版本是<code>DEVELOPMENT-SNAPSHOT-2016-06-06-a</code>, 但是这个时候这个new出来的项目的版本是 <code>DEVELOPMENT-SNAPSHOT-2016-06-20-a</code>,所以这就在‘vapor new’的时候会出现失败, 并且xcode7 也不能打开这个项目。</p>
<h4 id="如何构建一个纯净版的Vapor项目"><a href="#如何构建一个纯净版的Vapor项目" class="headerlink" title="如何构建一个纯净版的Vapor项目?"></a>如何构建一个纯净版的Vapor项目?</h4><ol>
<li><code>mkdir blog</code>创建一个blog文件夹</li>
<li><code>swift package init</code> 创建一个基本项目</li>
<li><p><code>atom Package.swift</code> 修改 Package.swift, 这里举例：</p>
<pre><code>import PackageDescription

let package = Package(
    name: &quot;blog&quot;,
    dependencies: [
        .Package(url: &quot;https://github.com/qutheory/vapor.git&quot;, majorVersion: 0, minor: 12),

    ],
    exclude: [
        &quot;Config&quot;,
        &quot;Database&quot;,
        &quot;Localization&quot;,
        &quot;Public&quot;,
        &quot;Resources&quot;,
        &quot;Tests&quot;,
    ]
)
</code></pre></li>
<li><p>Source文件夹下的文件改名为 <code>main.swift</code>， 在里面编写如下一段代码：</p>
<pre><code>import Vapor

let drop = Application()

drop.get(&quot;welcome&quot;) { request in

    return  &quot;hello, world&quot;
}

drop.start()
</code></pre></li>
<li><p>先<code>vapor build</code>,然后 <code>vapor xcode</code>， 会自动用xcode打开这个项目.</p>
</li>
<li>用xcode 运行这个项目（选中你这个项目）, 然后在浏览器中输入:<code>0.0.0.0:8080/welcome</code>, 你会神奇的发现出现了<code>hello, world</code>。</li>
</ol>
<h3 id="如何体验-vapor的更多功能"><a href="#如何体验-vapor的更多功能" class="headerlink" title="如何体验 vapor的更多功能"></a>如何体验 vapor的更多功能</h3><ol>
<li><p>请参考其 <a href="https://vapor.readme.io/docs" target="_blank" rel="noopener">doc</a></p>
</li>
<li><p>vapor的鼻祖的<a href="https://www.youtube.com/watch?v=OuPT2FFKCos" target="_blank" rel="noopener">教学视频</a></p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://loveli.site/2016/07/02/iOS 直播 Tutorials/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="loveli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="loveli">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/02/iOS 直播 Tutorials/" itemprop="url">iOS 直播 Tutorials</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-02T20:05:33+08:00">
                2016-07-02
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/07/02/iOS 直播 Tutorials/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/07/02/iOS 直播 Tutorials/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/07/02/iOS 直播 Tutorials/" class="leancloud_visitors" data-flag-title="iOS 直播 Tutorials">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-直播相关基本知识"><a href="#1-直播相关基本知识" class="headerlink" title="1.直播相关基本知识"></a>1.直播相关基本知识</h2><h3 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h3><pre><code>* 目前主流采用 服务器基于`nginx`，并且使用模块[nginx-rtmp-module](https://github.com/arut/nginx-rtmp-module)模块来增加对HLS的支持。
</code></pre><h3 id="协议"><a href="#协议" class="headerlink" title="协议:"></a>协议:</h3><p>国内常见公开的直播协议有几个：RTMP、HLS、HDL（HTTP-FLV）、RTP， 我们主要介绍 RTMP 和 HLS</p>
<ul>
<li><p><code>RTMP</code>(<a href="http://www.adobe.com/cn/devnet/rtmp.html" target="_blank" rel="noopener">Real Time Messaging Protocol</a>) 协议</p>
<p>  Adobe公司为Flash播放器和服务器之间音、视频及数据传输开发的实时消息传送协议。协议中，视频必须是H264编码，音频必须是AAC或MP3编码，且多以flv格式封包</p>
<ol>
<li>开源软件和开源库的支持稳定完整。如斗鱼主播常用的OBS软件，开源的librtmp库，服务端有nginx-rtmp插件。</li>
<li>播放端安装率高。只要浏览器支持FlashPlayer就能非常简易的播放RTMP的直播，协议详解可以Google了解。相对其他协议而言，RTMP协议初次建立连接的时候握手过程过于复杂（底层基于TCP，这里说的是RTMP协议本身的交互），视不同的网络状况会带来给首开带来100ms以上的延迟。基于RTMP的直播一般内容延迟在2~5秒。</li>
</ol>
</li>
<li><p><code>HLS</code>(<a href="https://developer.apple.com/streaming/" target="_blank" rel="noopener">HTTP Live Streaming</a>) 协议</p>
<p>  是由Apple公司定义的基于HTTP的流媒体实时传输协议。它的原理是将整个流分为一个一个小的文件来下载，每次只下载若干个。传输内容包括两部分：一是<code>M3U8</code>描述文件，二是<code>TS</code>媒体文件。TS媒体文件中的视频必须是<code>H264</code>编码,音频必须是<code>AAC</code>或<code>MP3</code>编码。</p>
<p>  HLS协议在服务器端将直播数据流存储为连续的、很短时长的媒体文件（MPEG-TS格式），而客户端则不断的下载并播放这些小文件，因为服务器端总是会将最新的直播数据生成新的小文件，这样客户端只要不停的按顺序播放从服务器获取到的文件，就实现了直播。由此可见，基本上可以认为，HLS是以点播的技术方式来实现直播。由于数据通过HTTP协议传输，所以完全不用考虑防火墙或者代理的问题，而且分段文件的时长很短，客户端可以很快的选择和切换码率，以适应不同带宽条件下的播放。不过HLS的这种技术特点，决定了它的延迟一般总是会高于普通的流媒体直播协议。</p>
<p>  HLS有一个非常大的<code>优点</code>：HTML5可以直接打开播放；这个意味着可以把一个直播链接通过微信等转发分享，不需要安装任何独立的APP，有浏览器即可，所以流行度很高。社交直播APP，HLS可以说是刚需</p>
</li>
</ul>
<h2 id="2-步骤："><a href="#2-步骤：" class="headerlink" title="2.步骤："></a>2.步骤：</h2><h3 id="音视频的采集"><a href="#音视频的采集" class="headerlink" title="音视频的采集"></a>音视频的采集</h3><p>使用AVFoundation.framework的AVCaptureSession即可获得原始的CMSampleBufferRef格式音视频数据</p>
<h3 id="对视频进行H264编码，对音频进行AAC编码"><a href="#对视频进行H264编码，对音频进行AAC编码" class="headerlink" title="对视频进行H264编码，对音频进行AAC编码"></a>对视频进行H264编码，对音频进行AAC编码</h3><p>将原始视频编码过程中，有两种方案：</p>
<ol>
<li>利用第三方库 <a href="https://github.com/FFmpeg/FFmpeg" target="_blank" rel="noopener">FFmpeg</a> 进行编码</li>
<li>利用iOS自身的AVAssetWriter 或VideoToolBox.framework的VTCompressionSession进行编码。</li>
</ol>
<h3 id="编码："><a href="#编码：" class="headerlink" title="编码："></a>编码：</h3><ol>
<li>RTMP上推直播视频: 对编码后的音、视频数据进行FLV封包；</li>
<li>HTTP Live Streaming直播: 视频和音频数据封装为MPEG-TS包</li>
</ol>
<h3 id="上推到服务端。"><a href="#上推到服务端。" class="headerlink" title="上推到服务端。"></a>上推到服务端。</h3><ol>
<li>基于RTMP进行推流的话：需要建立RTMP连接，</li>
<li>HTTP Live Streaming直播: 直接http进行数据传输</li>
</ol>
<h3 id="播放端-拉流-解密"><a href="#播放端-拉流-解密" class="headerlink" title="播放端 拉流 解密"></a>播放端 拉流 解密</h3><h2 id="3-IOS手机直播Demo流程"><a href="#3-IOS手机直播Demo流程" class="headerlink" title="3.IOS手机直播Demo流程"></a>3.IOS手机直播Demo流程</h2><h3 id="搭建本地测试服务器【Mac-os-10-11】"><a href="#搭建本地测试服务器【Mac-os-10-11】" class="headerlink" title="搭建本地测试服务器【Mac os 10.11】"></a>搭建本地测试服务器【Mac os 10.11】</h3><h4 id="服务器搭建"><a href="#服务器搭建" class="headerlink" title="服务器搭建"></a>服务器搭建</h4><p>打开终端</p>
<pre><code>brew update
brew install nginx-full --with-rtmp-module
</code></pre><p>如果你的mac之前安装了nginx, 那么这个时候先输入这个:</p>
<pre><code>brew unlink nginx
</code></pre><h4 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p>如果你本机上安装了atom,那么在terminal上输入：</p>
<pre><code>atom /usr/local/etc/nginx
</code></pre><p>将配置文件修改为：</p>
<pre><code>#user  nobody;
worker_processes  1;

#error_log  logs/error.log debug;
#error_log       /usr/local/var/log/nginx/error.log warn;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       8080;
        server_name  localhost;

        location /stat {
            rtmp_stat all;
            rtmp_stat_stylesheet stat.xsl;
        }

         # 这个路径一定要改
        location /stat.xsl {
            # you can move stat.xsl to a different location
            root /usr/local/Cellar/rtmp-nginx-module/1.1.7.10/share/rtmp-nginx-module;
        }

        # rtmp control
        location /control {
            rtmp_control all;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}

rtmp {
    server {
        listen 1935;
        ping 30s;
        notify_method get;

        application myapp {
            live on;

            # sample play/publish handlers
            #on_play http://localhost:8080/on_play;
            #on_publish http://localhost:8080/on_publish;

            # sample recorder
            #recorder rec1 {
            #    record all;
            #    record_interval 30s;
            #    record_path /tmp;
            #    record_unique on;
            #}

            # sample HLS
            #hls on;
            #hls_path /tmp/hls;
            #hls_sync 100ms;

        }

        application hls {
            live on;
            hls on;
            hls_path /tmp/hls;
            hls_fragment 5s;
        }

        # Video on demand
        #application vod {
        #    play /var/Videos;
        #}

        # Video on demand over HTTP
        #application vod_http {
        #    play http://localhost:8080/vod/;
        #}
    }
}
</code></pre><blockquote>
<p>注意： location /stat.xsl  { } 这个root的路径记得要改。 主要是改一下“1.1.7.10”，<br>跟你的rtmp-nginx-module这个版本有关系吧， 可以 <code>cd /usr/local/Cellar/rtmp-nginx-module/</code> 来查看</p>
</blockquote>
<h4 id="编辑好后，-进行-sudo-nginx-s-reload"><a href="#编辑好后，-进行-sudo-nginx-s-reload" class="headerlink" title="编辑好后， 进行  sudo nginx -s reload"></a>编辑好后， 进行  sudo nginx -s reload</h4><h3 id="采集音视频"><a href="#采集音视频" class="headerlink" title="采集音视频"></a>采集音视频</h3><p>用到是第三方的 <a href="https://github.com/runner365/LiveVideoCoreSDK" target="_blank" rel="noopener">LiveVideoCoreSDK</a></p>
<p>这边的话主要是改一下推流的url, 那么怎么样让手机访问的这个mac的本地服务器呢？</p>
<ol>
<li>mac 和手机在同一局域网(共连一个wifi)</li>
<li>然后打开本机的偏好设置-&gt;网络(Network), 看下你的wifi的status有个ip地址。或者你也可以用ipconfig进行才看 内网的ip地址。我的是192.168.1.100</li>
<li><p>更改LiveVideoCoreSDK上demo</p>
<pre><code>_RtmpUrlTextField.text = @&quot;rtmp://192.168.1.100:1935/myapp/mystream&quot;;
</code></pre></li>
<li><p>真机运行demo</p>
</li>
</ol>
<h3 id="播放端"><a href="#播放端" class="headerlink" title="播放端"></a>播放端</h3><p>安装ffplay：</p>
<pre><code>brew unlink ffmpeg
brew install ffmpeg --with-ffplay
</code></pre><h2 id="4-参考文献"><a href="#4-参考文献" class="headerlink" title="4.参考文献"></a>4.参考文献</h2><ol>
<li><a href="http://www.cocoachina.com/ios/20150818/13081.html" target="_blank" rel="noopener">HTTP Live Streaming直播(iOS直播)技术分析与实现</a></li>
<li><a href="http://blog.ucloud.cn/?p=796" target="_blank" rel="noopener"> 《关于直播，所有的技术细节都在这里了》 系列</a></li>
<li><a href="http://blog.csdn.net/leixiaohua1020/article/details/42658139" target="_blank" rel="noopener">FFmpeg相关资料 专栏文章</a></li>
<li><a href="https://github.com/runner365/LiveVideoCoreSDK" target="_blank" rel="noopener">LiveVideoCoreSDK</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">loveli</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/OHeroJ" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">loveli</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    





  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: '7uICtlktbqx7N1TEd1UP3AEB-gzGzoHsz',
        appKey: 'x22VJOsBnCbsSexO94REmioo',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("7uICtlktbqx7N1TEd1UP3AEB-gzGzoHsz", "x22VJOsBnCbsSexO94REmioo");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
